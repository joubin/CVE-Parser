{"Modified": "2016-08-23T22:00:24.933-04:00", "summary": "Moxa OnCell G3100V2 devices before 2.8 and G3111, G3151, G3211, and G3251 devices before 1.7 do not properly restrict authentication attempts, which makes it easier for remote attackers to obtain access via a brute-force attack.", "vulnerable_configuration_cpe_2_2": ["cpe:/o:moxa:oncell_g3001_firmware:1.6", "cpe:/h:moxa:oncell_g3251:-", "cpe:/h:moxa:oncell_g3211:-", "cpe:/h:moxa:oncell_g3151:-", "cpe:/h:moxa:oncell_g3111:-", "cpe:/o:moxa:oncell_g3100v2_firmware:2.7", "cpe:/h:moxa:oncell_g3100v2:-"], "last-modified": "2016-11-28T15:29:33.097-05:00", "references": ["http://www.securityfocus.com/bid/92606", "https://ics-cert.us-cert.gov/advisories/ICSA-16-236-01"], "ranking": [[{"circl": 2}]], "cwe": "CWE-285", "cvss": "10.0", "capec": [{"related_weakness": ["353", "285", "302", "472", "565", "315", "539", "384", "233"], "solutions": ["One solution to this problem is to protect encrypted data with a CRC of some sort. If knowing who last manipulated the data is important, then using a cryptographic \"message authentication code\" (or hMAC) is prescribed. However, this guidance is not a panacea. In particular, any value created by (and therefore encrypted by) the client, which itself is a \"malicious\" value, all the protective cryptography in the world can't make the value 'correct' again. Put simply, if the client has control over the whole process of generating and encoding the value, then simply protecting its integrity doesn't help.", "Make sure to protect client side authentication tokens for confidentiality (encryption) and integrity (signed hash)", "Make sure that all session tokens use a good source of randomness", "Perform validation on the server side to make sure that client side data tokens are consistent with what is expected."], "id": "39", "prerequisites": ["An attacker already has some access to the system or can steal the client based data tokens from another user who has access to the system.", "For an Attacker to viably execute this attack, some data (later interpreted by the application) must be held client-side in a way that can be manipulated without detection. This means that the data or tokens are not CRCd as part of their value or through a separate meta-data store elsewhere."], "summary": ["In circumstances where an application holds important data client-side in tokens (cookies, URLs, data files, and so forth) that data can be manipulated. If client or server-side application components reinterpret that data as authentication tokens or data (such as store item pricing or wallet information) then even opaquely manipulating that data may bear fruit for an Attacker. In this pattern an attacker undermines the assumption that client side tokens have been adequately protected from tampering through use of encryption or obfuscation."], "name": "Manipulating Opaque Client-based Data Tokens"}, {"related_weakness": ["120", "285", "302", "118", "119", "74", "20", "680", "697"], "solutions": ["Pay attention to the fact that the resource you read from can be a replaced by a Symbolic link. You can do a Symlink check before reading the file and decide that this is not a legitimate way of accessing the resource.", "Because Symlink can be modified by an attacker, make sure that the ones you read are located in protected directories.", "Pay attention to the resource pointed to by your symlink links (See attack pattern named \"Forced Symlink race\"), they can be replaced by malicious resources.", "Always check the size of the input data before copying to a buffer.", "Use a language or compiler that performs automatic bounds checking.", "Use an abstraction library to abstract away risky APIs. Not a complete solution.", "Compiler-based canary mechanisms such as StackGuard, ProPolice and the Microsoft Visual Studio /GS flag. Unless this provides automatic bounds checking, it is not a complete solution.", "Use OS-level preventative functionality. Not a complete solution."], "id": "45", "prerequisites": ["The attacker can create symbolic link on the target host.", "The target host does not perform correct boundary checking while consuming data from a resources."], "summary": ["This type of attack leverages the use of symbolic links to cause buffer overflows. An attacker can try to create or manipulate a symbolic link file such that its contents result in out of bounds data. When the target software processes the symbolic link file, it could potentially overflow internal buffers with insufficient bounds checking."], "name": "Buffer Overflow via Symbolic Links"}, {"related_weakness": ["285", "74", "693"], "solutions": ["Design: Enforce principle of least privilege", "Design: Harden registry server and file access permissions", "Implementation: Implement communications to and from the registry using secure protocols"], "id": "51", "prerequisites": ["The attacker must be able to write to resources or redirect access to the service registry."], "summary": ["SOA and Web Services often use a registry to perform look up, get schema information, and metadata about services. A poisoned registry can redirect (think phishing for servers) the service requester to a malicious service provider, provide incorrect information in schema or metadata (to effect a denial of service), and delete information about service provider interfaces.", "WS-Addressing is used to virtualize services, provide return addresses and other routing information, however, unless the WS-Addressing headers are protected they are vulnerable to rewriting. The attacker that can rewrite WS-addressing information gains the ability to route service requesters to any service providers, and the ability to route service provider response to any service.", "Content in a registry is deployed by the service provider. The registry in an SOA or Web Services system can be accessed by the service requester via UDDI or other protocol. The basic flow for the attacker consists of either altering the data at rest in the registry or uploading malicious content by spoofing a service provider. The service requester is then redirected to send its requests and/or responses to services the attacker controls."], "name": "Poison Web Service Registry"}, {"related_weakness": ["290", "330", "331", "346", "488", "539", "200", "6", "285", "384", "693", "719"], "solutions": ["Use a strong source of randomness to generate a session ID.", "Use adequate length session IDs", "Do not use information available to the user in order to generate session ID (e.g., time).", "Ideas for creating random numbers are offered by Eastlake [RFC1750]", "Encrypt the session ID if you expose it to the user. For instance session ID can be stored in a cookie in encrypted format."], "id": "59", "prerequisites": ["The target host uses session IDs to keep track of the users.", "Session IDs are used to control access to resources.", "The session IDs used by the target host are predictable. For example, the session IDs are generated using predictable information (e.g., time)."], "summary": ["This attack targets predictable session ID in order to gain privileges. The attacker can predict the session ID used during a transaction to perform spoofing and session hijacking."], "name": "Session Credential Falsification through Prediction"}, {"related_weakness": ["294", "290", "346", "384", "488", "539", "200", "285", "664", "732"], "solutions": ["Always invalidate a session ID after the user logout.", "Setup a session time out for the session IDs.", "Protect the communication between the client and server. For instance it is best practice to use SSL to mitigate man in the middle attack.", "Do not code send session ID with GET method, otherwise the session ID will be copied to the URL. In general avoid writing session IDs in the URLs. URLs can get logged in log files, which are vulnerable to an attacker.", "Encrypt the session data associated with the session ID.", "Use multifactor authentication."], "id": "60", "prerequisites": ["The target host uses session IDs to keep track of the users.", "Session IDs are used to control access to resources.", "The session IDs used by the target host are not well protected from session theft."], "summary": ["This attack targets the reuse of valid session ID to spoof the target system in order to gain privileges. The attacker tries to reuse a stolen session ID used previously during a transaction to perform spoofing and session hijacking. Another name for this type of attack is Session Replay."], "name": "Reusing Session IDs (aka Session Replay)"}, {"related_weakness": ["23", "22", "73", "77", "346", "348", "285", "264", "272", "59", "74", "15", "715"], "solutions": ["Design: Enforce principle of least privilege.", "Design: Ensure all input is validated, and does not contain file system commands", "Design: Run server interfaces with a non-root account and/or utilize chroot jails or other configuration techniques to constrain privileges even if attacker gains some limited access to commands.", "Design: For interactive user applications, consider if direct file system interface is necessary, instead consider having the application proxy communication.", "Implementation: Perform testing such as pen-testing and vulnerability scanning to identify directories, programs, and interfaces that grant direct access to executables."], "id": "76", "prerequisites": ["Program must allow for user controlled variables to be applied directly to the filesystem"], "summary": ["An attacker manipulates inputs to the target software which the target software passes to file system calls in the OS. The goal is to gain access to, and perhaps modify, areas of the file system that the target software did not intend to be accessible."], "name": "Manipulating Input to File System Calls"}, {"related_weakness": ["473", "15", "285", "302", "94", "96"], "solutions": ["If the register_globals option is enabled, PHP will create global variables for each GET, POST, and cookie variable included in the HTTP request. This means that a malicious user may be able to set variables unexpectedly. For instance make sure that the server setting for PHP does not expose global variables.", "A software system should be reluctant to trust variables that have been initialized outside of its trust boundary. Ensure adequate checking is performed when relying on input from outside a trust boundary.", "Separate the presentation layer and the business logic layer. Variables at the business logic layer should not be exposed at the presentation layer. This is to prevent computation of business logic from user controlled input data.", "Use encapsulation when declaring your variables. This is to lower the exposure of your variables.", "Assume all input is malicious. Create a white list that defines all valid input to the software system based on the requirements specifications. Input that does not match against the white list should be rejected by the program."], "id": "77", "prerequisites": ["A variable consumed by the application server is exposed to the client.", "A variable consumed by the application server can be overwritten by the user.", "The application server trusts user supplied data to compute business logic.", "The application server does not perform proper input validation."], "summary": ["This attack targets user controlled variables (DEBUG=1, PHP Globals, and So Forth). An attacker can override environment variables leveraging user-supplied, untrusted query variables directly used on the application server without any data sanitization. In extreme cases, the attacker can change variables controlling the business logic of the application. For instance, in languages like PHP, a number of poorly set default configurations may allow the user to override variables."], "name": "Manipulating User-Controlled Variables"}, {"related_weakness": ["425", "285", "693"], "solutions": ["Authenticate request to every resource. In addition, every page or resource must ensure that the request it is handling has been made in an authorized context.", "Forceful browsing can also be made difficult to a large extent by not hard-coding names of application pages or resources. This way, the attacker cannot figure out, from the application alone, the resources available from the present context."], "id": "87", "prerequisites": ["The forcibly browseable pages or accessible resources must be discoverable and improperly protected."], "summary": ["An attacker employs forceful browsing to access portions of a website that are otherwise unreachable through direct URL entry.", "Usually, a front controller or similar design pattern is employed to protect access to portions of a web application.", "Forceful browsing enables an attacker to access information, perform privileged operations and otherwise reach sections of the web application that have been improperly protected."], "name": "Forceful Browsing"}, {"related_weakness": ["285", "732", "276", "693", "721", "434"], "solutions": ["In a more general setting, the administrator must mark every resource besides the ones supposed to be exposed to the user as accessible by a role impossible for the user to assume. The default security setting must be to deny access and then grant access only to those resources intended by business logic."], "id": "1", "prerequisites": ["The application must be navigable in a manner that associates elements (subsections) of the application with ACLs.", "The various resources, or individual URLs, must be somehow discoverable by the attacker", "The administrator must have forgotten to associate an ACL or has associated an inappropriately permissive ACL with a particular navigable resource."], "summary": ["In applications, particularly web applications, access to functionality is mitigated by the authorization framework, whose job it is to map ACLs to elements of the application's functionality; particularly URL's for web apps. In the case that the administrator failed to specify an ACL for a particular element, an attacker may be able to access it with impunity. An attacker with the ability to access functionality not properly constrained by ACLs can obtain sensitive information and possibly compromise the entire application. Such an attacker can access resources that must be available only to users at a higher privilege level, can access management sections of the application or can run queries for data that he is otherwise not supposed to."], "name": "Accessing Functionality Not Properly Constrained by ACLs"}, {"related_weakness": ["424", "425", "288", "285", "732", "276", "693", "721"], "solutions": ["1. Using blank index.html: putting blank index.html simply prevent directory listings from displaying to site visitors.", "2. Preventing with .htaccess in Apache web server: In .htaccess, write \"Options-indexes\".", "3. Suppressing error messages: using error 403 \"Forbidden\" message exactly like error 404 \"Not Found\" message."], "id": "127", "prerequisites": ["The target must be misconfigured to return a list of a directory's content when it receives a request that ends in a directory name rather than a file name.", "The adversary must be able to control the path that is requested of the target.", "The administrator must have failed to properly configure an ACL or has associated an overly permissive ACL with a particular directory.", "The server version or patch level must not inherently prevent known directory listing attacks from working."], "summary": ["An adversary crafts a request to a target that results in the target listing/indexing the content of a directory as output. One common method of triggering directory contents as output is to construct a request containing a path that terminates in a directory name rather than a file name since many applications are configured to provide a list of the directory's contents when such a request is received. An adversary can use this to explore the directory tree on a target as well as learn the names of files. This can often end up revealing test files, backup files, temporary files, hidden files, configuration files, user accounts, script contents, as well as naming conventions, all of which can be used by an attacker to mount additional attacks."], "name": "Directory Indexing"}, {"related_weakness": ["353", "285", "302", "74", "15", "73", "20", "200"], "solutions": ["Protect environment variables against unauthorized read and write access.", "Protect the configuration files which contain environment variables against illegitimate read and write access.", "Assume all input is malicious. Create a white list that defines all valid input to the software system based on the requirements specifications. Input that does not match against the white list should not be permitted to enter into the system.", "Apply the least privilege principles. If a process has no legitimate reason to read an environment variable do not give that privilege."], "id": "13", "prerequisites": ["An environment variable is accessible to the user.", "An environment variable used by the application can be tainted with user supplied data.", "Input data used in an environment variable is not validated properly.", "The variables encapsulation is not done properly. For instance setting a variable as public in a class makes it visible and an attacker may attempt to manipulate that variable."], "summary": ["The attacker directly or indirectly modifies environment variables used by or controlling the target software. The attacker's goal is to cause the target software to deviate from its expected operation in a manner that benefits the attacker."], "name": "Subverting Environment Variable Values"}, {"related_weakness": ["732", "285", "272", "59", "282", "275", "264", "270", "693"], "solutions": ["Design: Enforce principle of least privilege", "Design: Run server interfaces with a non-root account and/or utilize chroot jails or other configuration techniques to constrain privileges even if attacker gains some limited access to commands.", "Implementation: Perform testing such as pen-testing and vulnerability scanning to identify directories, programs, and interfaces that grant direct access to executables."], "id": "17", "prerequisites": ["System's configuration must allow an attacker to directly access executable files or upload files to execute. This means that any access control system that is supposed to mediate communications between the subject and the object is set incorrectly or assumes a benign environment."], "summary": ["An attack of this type exploits a system's configuration that allows an attacker to either directly access an executable file, for example through shell access; or in a possible worst case allows an attacker to upload a file and then execute it. Web servers, ftp servers, and message oriented middleware systems which have many integration points are particularly vulnerable, because both the programmers and the administrators must be in synch regarding the interfaces and the correct privileges for each interface."], "name": "Accessing, Modifying or Executing Executable Files"}, {"related_weakness": ["250", "638", "285", "116", "20"], "solutions": ["Disable script execution.", "Ensure that sufficient input validation is performed for any potentially untrusted data before it is used in any privileged context or zone", "Limit the flow of untrusted data into the privileged areas of the system that run in the higher trust zone", "Limit the sites that are being added to the local machine zone and restrict the privileges of the code running in that zone to the bare minimum", "Ensure proper HTML output encoding before writing user supplied data to the page"], "id": "104", "prerequisites": ["The target must be using a zone-aware browser."], "summary": ["An attacker is able to cause a victim to load content into their web-browser that bypasses security zone controls and gain access to increased privileges to execute scripting code or other web objects such as unsigned ActiveX controls or applets. This is a privilege elevation attack targeted at zone-based web-browser security. In a zone-based model, pages belong to one of a set of zones corresponding to the level of privilege assigned to that page. Pages in an untrusted zone would have a lesser level of access to the system and/or be restricted in the types of executable content it was allowed to invoke. In a cross-zone scripting attack, a page that should be assigned to a less privileged zone is granted the privileges of a more trusted zone. This can be accomplished by exploiting bugs in the browser, exploiting incorrect configuration in the zone controls, through a cross-site scripting attack that causes the attackers' content to be treated as coming from a more trusted page, or by leveraging some piece of system functionality that is accessible from both the trusted and less trusted zone. This attack differs from \"Restful Privilege Escalation\" in that the latter correlates to the inadequate securing of RESTful access methods (such as HTTP DELETE) on the server, while cross-zone scripting attacks the concept of security zones as implemented by a browser."], "name": "Cross Zone Scripting"}], "id": "CVE-2016-5799", "Published": "2016-08-23T22:00:24.087-04:00", "vulnerable_configuration": [{"title": "cpe:2.3:o:moxa:oncell_g3001_firmware:1.6", "id": "cpe:2.3:o:moxa:oncell_g3001_firmware:1.6"}, {"title": "cpe:2.3:h:moxa:oncell_g3251", "id": "cpe:2.3:h:moxa:oncell_g3251"}, {"title": "cpe:2.3:h:moxa:oncell_g3211", "id": "cpe:2.3:h:moxa:oncell_g3211"}, {"title": "cpe:2.3:h:moxa:oncell_g3151", "id": "cpe:2.3:h:moxa:oncell_g3151"}, {"title": "cpe:2.3:h:moxa:oncell_g3111", "id": "cpe:2.3:h:moxa:oncell_g3111"}, {"title": "cpe:2.3:o:moxa:oncell_g3100v2_firmware:2.7", "id": "cpe:2.3:o:moxa:oncell_g3100v2_firmware:2.7"}, {"title": "cpe:2.3:h:moxa:oncell_g3100v2", "id": "cpe:2.3:h:moxa:oncell_g3100v2"}]}