class Keywords:
    def __init__(self, keywords: list = None):
        if keywords is None:
            keywords = []
        self.keywords = keywords
        self.count = 0

    def add_keyword(self, word: str):
        self.keywords.append(word)

    def remove_keyword(self, word: str):
        self.keywords.remove(word)

    def increment_count(self):
        self.count += 1

    def contains_keyword(self, word_to_compare: str) -> bool:
        if any(items.lower() in word_to_compare.lower() for items in self.keywords):
            return True
        return False

    def increment_if_contain(self, word_to_compare: str):
        if self.contains_keyword(word_to_compare):
            self.increment_count()
            return True
        else:
            return False

    @staticmethod
    def keywords_to_list(keywords: iter) -> list:
        return list(sum([item.keywords for item in keywords], []))

if __name__ == '__main__':
    attack_types = dict()
    attack_types["XSS"] = Keywords(["cross site scripting", "xss", "cross-site-scripting", "cross-site scripting", "cross site-scripting", "xsite scripting"])
    attack_types['injection'] = Keywords(["sql injection", "injection", "sqli"])
    attack_types['csrf'] = Keywords(["cross site request forgery", "csrf", "cross-site-request-forgery", "cross-site request forgery"])
    attack_types['buffer_overflow'] = Keywords(["bfo", "buffer overflow", "overflow"])
    attack_types['deserialization'] = Keywords(["deserialization attack", "deserialization", "serialization"])
    attack_types['parsing'] = Keywords(["parse", "misparse"])
    attack_types['memorycorruption'] = Keywords(["Memory Corruption Vulnerability"])
    sublist = Keywords.keywords_to_list(attack_types.values())
    print(sublist)

    print(attack_types['memorycorruption'].contains_keyword("""The Microsoft (1) VBScript 5.7 and 5.8 and (2) JScript 5.7 and 5.8 engines, as used in Internet Explorer 8 through 11 and other products, allow remote attackers to execute arbitrary code via a crafted web site, aka "Scripting Engine Memory Corruption Vulnerability."
"""))
